---
- name: Create a bridge that has all devices except router main lan 
  hosts: all
  remote_user: root
  tasks:
    - name: Print the devices
      debug:
        var: with_internet_devices

    - name: Print the devices
      debug:
        var: without_internet_devices

    - name: Create OVS bridge
      command: "ovs-vsctl add-br br0"

    - name: Add interfaces to bridge that are not empty
      command: "ovs-vsctl add-port br0 {{ item }}"
      with_items: "{{ with_internet_devices.split(',') + without_internet_devices.split(',') }}"
      when: item|trim != ''
